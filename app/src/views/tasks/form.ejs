<% const isEdit = !!task; %>
<%- include("../layout", { title: isEdit ? "Edit Task" : "New Task", body: `
  <h1>${isEdit ? "Edit Task" : "New Task"}</h1>
  <form method="post" action="${isEdit ? `/tasks/${task.id}` : "/tasks"}">
    <div>
      <label>Title</label><br/>
      <input name="title" value="${isEdit ? task.title : ""}" required />
    </div>

    <div>
      <label>Done</label>
      <input type="checkbox" name="done" ${isEdit && task.done ? "checked" : ""} />
    </div>

    <div>
      <label>User</label><br/>
      <select name="user_id">
        <option value="">-- none --</option>
        ${users.map(u => `
          <option value="${u.id}" ${isEdit && task.user_id === u.id ? "selected" : ""}>${u.name}</option>
        `).join("")}
      </select>
    </div>

    <div>
      <label>Project</label><br/>
      <select name="project_id">
        <option value="">-- none --</option>
        ${projects.map(p => `
          <option value="${p.id}" ${isEdit && task.project_id === p.id ? "selected" : ""}>${p.name}</option>
        `).join("")}
      </select>
    </div>

    <button type="submit">Save</button>
  </form>
` }) %>